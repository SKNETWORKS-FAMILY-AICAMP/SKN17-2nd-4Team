# ğŸŸ¦ SKë„¤íŠ¸ì›ìŠ¤ Family AI ìº í”„ 17ê¸°Â 2ì°¨Â í”„ë¡œì íŠ¸_ 4Team ğŸŸ¦


#  1.Â íŒ€Â ì†Œê°œ
### â–¶ï¸ íŒ€ëª… :  **ê³µê³µì‚¼**

#### 'ê³µê³µì‚¼'ì€ 00ë…„ìƒ 3ëª…ê³¼ 03ë…„ìƒ 1ëª…ì´ í•˜ë‚˜ê°€ ë˜ì–´ íŒ€ì„ ì´ë£¨ì—ˆë‹¤ëŠ” ëœ»ê³¼ ì„¸ ê°€ì§€ 'ê³µ'ì¸ ê³µìœ , ê³µê°, ê³µì¡°ë¥¼ í•µì‹¬ê°€ì¹˜ë¡œ ì¡°í™”ë¡œìš´ íŒ€ì„ ì´ë£¨ê² ë‹¤ëŠ” ì˜ë¯¸ë¥¼ ë‹´ì•˜ìŠµë‹ˆë‹¤. 

<br>

### â–¶ï¸ íŒ€ì› ì†Œê°œ 
|[ê¹€ì£¼ì˜](https://github.com/samkim7788)|[ì „ìƒì•„](https://github.com/sang-a-le)|[ì¡°í•´ë¦¬](https://github.com/Haer111)|[ìµœìš°ì§„](https://github.com/CHUH00)|
|:---|:---|:---|:---|
|<img width="100" height="100" src="https://github.com/SKNETWORKS-FAMILY-AICAMP/SKN17-2nd-4Team/blob/main/image/%EB%B8%8C%EB%A0%88%EB%93%9C.png" />|<img width="100" height="100" src="https://github.com/SKNETWORKS-FAMILY-AICAMP/SKN17-2nd-4Team/blob/main/image/%EB%B0%80%ED%81%AC.png" />|<img width="100" height="100" src="https://github.com/SKNETWORKS-FAMILY-AICAMP/SKN17-2nd-4Team/blob/main/image/%EC%B4%88%EC%BD%94.png" />|<img width="100" height="100" src="https://github.com/SKNETWORKS-FAMILY-AICAMP/SKN17-2nd-4Team/blob/main/image/%EA%B0%90%EC%9E%90%EC%B9%A9.png" />|

<br>

-----

# 2.Â í”„ë¡œì íŠ¸Â ê°œìš”

### â–¶ï¸ í”„ë¡œì íŠ¸Â ëª… 

### **ğŸƒâ€â™€ï¸â€â¡ï¸ë– ë‚ ê¹Œ? ë§ê¹Œ?ğŸƒâ€â™€ï¸**
#### SNS ì‚¬ìš©ì ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ 'í˜ì´ìŠ¤ë¶' ì´íƒˆ ê°€ëŠ¥ì„± ì˜ˆì¸¡ ëª¨ë¸ ë° ì˜ˆì¸¡ ì„œë¹„ìŠ¤ ì œê³µ

<br>

-----

### â–¶ï¸ í”„ë¡œì íŠ¸Â ì†Œê°œ 
í•´ë‹¹ í”„ë¡œì íŠ¸ëŠ” SNS ì‚¬ìš©ì ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê°œì¸ íŠ¹ì„±ì„ ë¶„ì„í•˜ì—¬ í–¥í›„ í”Œë«í¼ ì´íƒˆ ê°€ëŠ¥ì„± ì˜ˆì¸¡í•œë‹¤. 
íŠ¹íˆ, í˜ì´ìŠ¤ë¶ì„ 1ìˆœìœ„ë¡œ ì„ íƒí•œ ì‚¬ìš©ìë¥¼ ê¸°ë°˜ìœ¼ë¡œ í˜ì´ìŠ¤ë¶ ì‚¬ìš©ì ì´íƒˆ ëª¨ë¸ì„ í•™ìŠµí•´ í–¥í›„ ì‚¬ìš©ì íŠ¹ì„± ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì ì¬ì  ì´íƒˆì íŒë³„ ì„œë¹„ìŠ¤ ì œê³µì„ ëª©í‘œë¡œ í•œë‹¤. 

<br>

-----

### â–¶ï¸ í”„ë¡œì íŠ¸Â ë°°ê²½
<br>

<img width="551" height="210" alt="image" src="https://github.com/user-attachments/assets/3954c807-02cf-4edb-ab48-04ec4bec4a9d" />

> https://www.chosun.com/economy/tech_it/2023/03/10/NEL65GJO2ZGUXJHVGNCAC4Y354/


> êµ­ë‚´ í˜ì´ìŠ¤ë¶ ì›” ì´ìš©ìê°€ ì²˜ìŒìœ¼ë¡œ 1000ë§Œëª… ì´í•˜ë¡œ ë–¨ì–´ì¡Œë‹¤. ì‚¬ì§„ì´ë‚˜ ì§§ì€ ë™ì˜ìƒ ìœ„ì£¼ì˜ ì†Œì…œë¯¸ë””ì–´ë¥¼ ì„ í˜¸í•˜ëŠ” 10Â·20ëŒ€ ì´ìš©ìì˜ ì´íƒˆì´ ê°€ì†í™”í•˜ê³  ìˆê¸° ë•Œë¬¸ìœ¼ë¡œ í’€ì´ëœë‹¤.

> ì¡°ì„ ì¼ë³´, ë³€í¬ì›, 2023.03.10


ìœ„ì˜ ê¸°ì‚¬ ë‚´ìš©ê³¼ ê°™ì´ 2023ë…„ êµ­ë‚´ í˜ì´ìŠ¤ë¶ ì›” ì´ìš©ìê°€ ì²˜ìŒìœ¼ë¡œ 1000ë§Œëª… ì´í•˜ë¡œ ë–¨ì–´ì§€ëŠ” ë“± í˜ì´ìŠ¤ë¶ ì‚¬ìš©ìê°€ ì§€ì†ì ìœ¼ë¡œ ê°ì†Œí•˜ëŠ” ì–‘ìƒì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. 

<br>
<br>

<img width="500" height="300" src='https://github.com/SKNETWORKS-FAMILY-AICAMP/SKN17-2nd-4Team/blob/main/image/%ED%8E%98%EC%9D%B4%EC%8A%A4%EB%B6%81%20%EC%9D%B4%EC%9A%A9%20%EA%B7%B8%EB%9E%98%ED%94%84%201.jpg'>

> https://www.i-boss.co.kr/ab-6141-59928

> ì¶œì²˜ : ì˜¤í”ˆì„œë² ì´ ì†Œì…œë¯¸ë””ì–´Â·ê²€ìƒ‰í¬í„¸ íŠ¸ë Œë“œ ë¦¬í¬íŠ¸ 2023

ìœ„ì˜ ê·¸ë˜í”„ëŠ” 2023ë…„ ë°œí‘œëœ ì˜¤í”ˆì„œë² ì´ì˜ ì†Œì…œë¯¸ë””ì–´Â·ê²€ìƒ‰í¬í„¸ íŠ¸ë Œë“œ ë¦¬í¬íŠ¸ì—ì„œ ë°œí‘œëœ ê·¸ë˜í”„ì´ë‹¤. 
ìµœê·¼ ì¼ì£¼ì¼ ë‚´ ì‚¬ìš©í•œ ì†Œì…œë„¤íŠ¸ì›Œí¬ ì‹œìŠ¤í…œ ìˆœìœ„ ì¤‘ í˜ì´ìŠ¤ë¶ì´ 22.6%ë¡œ 7ìœ„ë¥¼ ê¸°ë¡í•˜ëŠ” ë“± ë™ì¼í•œ ë¦¬í¬íŠ¸ì—ì„œ 2019ë…„ 3ìœ„ë¥¼ ê¸°ë¡í–ˆë˜ ê²ƒì— ë¹„í•´ ë§ì´ ë–¨ì–´ì§„ ìˆœìœ„ë¥¼ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤.

<br>
<br>

<img width="600" height="450" alt="image" src="https://github.com/user-attachments/assets/13150251-0be3-43a7-96bd-6e85accadd69" />

> https://www.wiseapp.co.kr/insight/detail/517

> ì¶œì²˜ : 2024. ì™€ì´ì¦ˆì•±Â·ë¦¬í…Œì¼ 'í¬ë¹„ ì—‡ê°ˆë¦° SNS ì•± ì¸ìŠ¤íƒ€ê·¸ë¨ vs í˜ì´ìŠ¤ë¶ ë¹„êµ'

<br>
<br>

|<img width="600" height="300" alt="image" src="https://github.com/user-attachments/assets/639bc8a7-162e-41fd-b1b6-89720eb2fd2c" />|<img width="600" height="300" alt="image" src="https://github.com/user-attachments/assets/86dc6a9c-85ed-4db8-a7c7-95c873108c5d" />|
|:---|:---|
| í˜ì´ìŠ¤ë¶ ì•± ì‚¬ìš©ì ë° ì‚¬ìš©ì‹œê°„ ì¶”ì´ | ì¸ìŠ¤íƒ€ê·¸ë¨, í˜ì´ìŠ¤ë¶ ì•± ì›”ê°„ ì‚¬ìš©ì ì¶”ì´ |

<br>

ìœ„ì˜ ê·¸ë˜í”„ë‘˜ì—ì„œ í™•ì¸ëœ ë°”ì™€ ê°™ì´ í˜ì´ìŠ¤ë¶ì˜ ì‚¬ìš© ì¶”ì´ê°€ ì§€ì†ì ìœ¼ë¡œ ê°ì†Œë˜ê³  ìˆìŠµë‹ˆë‹¤. 

#### í˜„ì¬ 2030 ì„¸ëŒ€ì˜ ê²½ìš°, í•™ì°½ì‹œì ˆ í˜ì´ìŠ¤ë¶ì„ ê°€ì¥ ì£¼ëœ SNSë¡œ ì‚¬ìš©í–ˆë˜ ì„¸ëŒ€ì´ê¸°ë„ í•˜ì§€ë§Œ í˜ì´ìŠ¤ë¶ ì´íƒˆë¥ ì´ ê°€ì¥ ë§ì€ ì„¸ëŒ€ë¼ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

#### ê³¼ê±° ë§ì€ íŒŒê¸‰ë ¥ì„ ì£¼ì—ˆë˜ í˜ì´ìŠ¤ë¶ì˜ ì‚¬ìš©ì ê°ì†Œì— ëŒ€í•œ ì˜ë¬¸ì´ í•´ë‹¹ í”„ë¡œì íŠ¸ ì£¼ì œ ì„ ì •ì— ì˜í–¥ì„ ì£¼ì—ˆê³ , ì´ì— ë”°ë¼ ì €í¬ëŠ” SNS ì‚¬ìš©ìì˜ ê°œì¸ íŠ¹ì„± ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í˜ì´ìŠ¤ë¶ ì´íƒˆë¥  ì˜ˆì¸¡ì„ í•˜ê³ ì í•©ë‹ˆë‹¤. 

<br>
<br>

-----

### â–¶ï¸ í”„ë¡œì íŠ¸Â ëª©í‘œ 
#### 1. ì‚¬ìš©ì íŠ¹ì„± ë°ì´í„°ë¥¼ ì´ìš©í•œ í˜ì´ìŠ¤ë¶ ì‚¬ìš©ì ì´íƒˆë¥  íŒŒì•…
#### 2. ì‹¤ì œ ë°ì´í„° ì£¼ì… ì‹œ ì´íƒˆë¥  ì˜ˆì¸¡
#### 3. í˜ì´ìŠ¤ë¶ ì™¸ì˜ ë‹¤ë¥¸ SNSì˜ ì´íƒˆë¥  íŒŒì•…ìœ¼ë¡œ ì¸ì‚¬ì´íŠ¸ í™•ì¥


<br>
<br>

-----

### â–¶ï¸ ìˆ˜ì§‘ë°ì´í„° ì„¤ëª…
[ë¯¸ë””ì–´í†µê³„í¬í„¸ ë¯¸ë””ì–´íŒ¨ë„ì¡°ì‚¬]
- ì¶œì²˜ : ë¯¸ë””ì–´ í†µê³„ í¬í„¸(https://stat.kisdi.re.kr/)
- ìˆ˜ì§‘ ë°©ë²• : ë¯¸ë””ì–´ í†µê³„ í¬í„¸ì—ì„œ ì œê³µí•˜ëŠ” ì—°ë„ë³„ í•œêµ­ ë¯¸ë””ì–´ íŒ¨ë„ ì¡°ì‚¬ ë°ì´í„°ì…‹ csv íŒŒì¼ ë‹¤ìš´ë¡œë“œ.
- ë°ì´í„° ì¶œì²˜ ë° ë²”ìœ„
    - ìˆ˜ì§‘ ë°ì´í„° ê¸°ê°„: 2019ë…„ 1ì›” ~ 2024ë…„ 12ì›”
    - ë°ì´í„° ë²”ìœ„ : ê°œì¸ ì •ë³´ ë° ë¯¸ë””ì–´ ì´ìš© ì¤‘ SNS ì‚¬ìš© ê´€ë ¨ ì§ˆë¬¸ 
    - ì£¼ìš” ë³€ìˆ˜ : SNS ì‚¬ìš© ë¹ˆë„, ê°œì¸ì •ë³´(ë‚˜ì´, ì„±ë³„, í•™ë ¥, ê²°í˜¼ ì—¬ë¶€, ì¢…êµ, ìˆ˜ì… ë“±), ì‚¬ìš©í•˜ëŠ” SNS ì¢…ë¥˜
- ì„¤ëª… 
    : ë¯¸ë””ì–´ í†µê³„ í¬í„¸ì—ì„œ ì´ë£¨ì–´ì§„ í•œêµ­ ë¯¸ë””ì–´ íŒ¨ë„ ì¡°ì‚¬ ë°ì´í„°ì…‹ì„ ë¶„ì„í•˜ì—¬ ê³ ê°ì˜ ë‹¤ì–‘í•œ íŠ¹ì„±(ë‚˜ì´, ì„±ë³„, í•™ë ¥, ê²°í˜¼ ì—¬ë¶€, ì¢…êµ, ìˆ˜ì… ë“±)ê³¼ SNS ì‚¬ìš© ë¹ˆë„ ê´€ë ¨ ì„¤ë¬¸ ë°ì´í„°ì— ë”°ë¥¸ í˜ì´ìŠ¤ë¶ ì´íƒˆ ê°€ëŠ¥ì„±ì„ ì˜ˆì¸¡

<br>
<br>

-----

# 3.Â ê¸°ìˆ Â ìŠ¤íƒ
|ê°œë°œë„êµ¬|í˜‘ì—…ë„êµ¬|í”„ë¡œê·¸ë˜ë° ì–¸ì–´|ë°ì´í„° ì „ì²˜ë¦¬|ë°ì´í„° ì‹œê°í™”|ë¨¸ì‹ ëŸ¬ë‹|
|---|---|---|---|---|---|
|vscode|Github|Python|Pandas / numpy|Matplotlib|scikit learn|
| <img src='https://img.shields.io/badge/Visual%20Studio%20Code-0078d7.svg?style=for-the-badge&logo=visual-studio-code&logoColor=white'>|<img src="https://img.shields.io/badge/github-181717?style=for-the-badge&logo=github&logoColor=white"> <img src="https://img.shields.io/badge/git-F05032?style=for-the-badge&logo=git&logoColor=white">|<img src="https://img.shields.io/badge/python-3776AB?style=for-the-badge&logo=python&logoColor=white">|<img src="https://img.shields.io/badge/pandas-%23150458.svg?style=for-the-badge&logo=pandas&logoColor=white"> <img src='https://img.shields.io/badge/numpy-%23013243.svg?style=for-the-badge&logo=numpy&logoColor=white'>|<img src='https://img.shields.io/badge/Matplotlib-%23ffffff.svg?style=for-the-badge&logo=Matplotlib&logoColor=black'>| <img src="https://img.shields.io/badge/Scikit-learn-F7931E?style=for-the-badge&logo=scikit-learn&logoColor=white"/>|

<br>
<br>

-----

# 4. WBS
![WBSì´ë¯¸ì§€](https://github.com/SKNETWORKS-FAMILY-AICAMP/SKN17-2nd-4Team/blob/main/image/WBS.png)

<br>
<br>

-----

# 5.Â ë°ì´í„° ì „ì²˜ë¦¬ ê²°ê³¼ì„œ (EDA)

## ğŸ‘‰ ìµœì¢… ë°ì´í„° (19ë…„ë„ /24ë…„ë„, 2ê°œë…„ ë¹„êµ)
### ğŸ”¹ 1. ë°ì´í„° ë¡œë“œ 
```python
df = pd.read_csv('./data/p19v31_KMP_csv.csv', encoding='CP949')

feature = ['pid', 'p19age', 'p19gender', 'p19school', 'p19mar', 'p19job1', 'p19job2', 'p19job4', 'p19income', 'p19relig2', 'p19d27001', 'p19d27002', 'p19d27003', 'p19d27004', 'p19d11002', 'p19d11004', 'p19d11006']

df_19 = df[feature].copy()

df_19.rename(
    columns={
        'p19age': 'age', 
        'p19gender': 'gender', 
        'p19school': 'school', 
        'p19mar': 'mar', 
        'p19job1': 'job', 
        'p19job2': 'job_o',
        'p19job4': 'job_x',
        'p19income': 'income', 
        'p19relig2': 'relig',
        'p19d27001': 'd01', 
        'p19d27002': 'd02', 
        'p19d27003': 'd03', 
        'p19d27004': 'd04',
        'p19d11002': 'label_1',
        'p19d11004': 'label_2', 
        'p19d11006': 'label_3'
    }, inplace=True
)

df_19['year'] = 2019

df_19.head()
```
<img width="1303" height="193" alt="image" src="https://github.com/user-attachments/assets/990f4250-728e-48b5-bf49-b33ab7db3424" />

<br>
<br>

### ğŸ”¹ 2. ë³€ìˆ˜ ë³€í™˜
#### * ìœ /ë¬´ì§ì ì»¬ëŸ¼ ë³‘í•© ë° ì •ì œ
```python
# ìœ ì§ì ë²ˆí˜¸ ë³€ê²½
df_all['job_o'] = df_all['job_o'].replace({'1': '5', '2': '6', '3': '7', '4': '2', '9999': '8'})
print(df_all['job_o'].value_counts())
```

<br>

#### * ë°ì´í„° ë§µí•‘
  - ë°ì´í„° ì‚¬ìš© ë¹ˆë„ì— ëŒ€í•´ ë§µí•‘
  
  |<img width="238" height="176" alt="image" src="https://github.com/user-attachments/assets/8cecaa34-7fbf-4067-a515-5eb51792f206" /> | <img width="238" height="176" alt="image" src="https://github.com/user-attachments/assets/e1f9bf73-ceb4-403b-9005-fef9ad932e19" />|
  |---|---|
  |ê¸°ì¡´ê°’|ë§µí•‘ í›„|

<br>

#### * ë¼ë²¨ë°ì´í„° ì¬ìƒì„±
```python
# ë¼ë²¨ ê¸°ì´ˆ ë°ì´í„° ë³€í™˜ (3ìˆœìœ„ í¬í•¨)
df_24['label'] = (df_24[['label_1', 'label_2', 'label_3']].isin(['2']).any(axis=1).astype(int))
print(sum(df_24['label'] == 1), sum(df_24['label'] == 0))

# labelì˜ ë‹¤ìŒ ì—°ë„ ê°’
df_all['next_year_label'] = df_all.groupby('pid')['label'].shift(-1)
df_all

# ë¼ë²¨ ë°ì´í„° ìƒì„± = ì´íƒˆ(churn) ì—¬ë¶€ ì •ì˜ 
churn_conditions = [
    (df_all['label'] == 1) & (df_all['next_year_label'].notna()) & (df_all['next_year_label'] != 1),
    (df_all['label'] == 1) & (df_all['next_year_label'].notna()) & (df_all['next_year_label'] == 1)
]
churn_choices = [1, 0] # 1: ì´íƒˆ (Churn), 0: ë¹„ì´íƒˆ (Not Churn)

df_all['churn'] = np.select(churn_conditions, churn_choices, default=np.nan)
```

<br>

#### * ê²°ì¸¡ì¹˜ ì œê±°
```python
df_all = df_all[df_all['label'].str.strip() != ''].reset_index(drop=True)
```

<br>

#### * ì´íƒˆ(churn) ë³€ìˆ˜ ì •ì˜
```python
df_all['next_year_label'] = df_all.groupby('pid')['label'].shift(-1) # ê° pid ê·¸ë£¹ì— ëŒ€í•œ ë‹¤ìŒ ì—°ë„ì˜ label ê°’ ë°˜í™˜

churn_conditions = [
    (df_all['label'] == '2') & (df_all['next_year_label'].notna()) & (df_all['next_year_label'] != '2'),
    (df_all['label'] == '2') & (df_all['next_year_label'].notna()) & (df_all['next_year_label'] == '2')
]
churn_choices = [1, 0] # 1: ì´íƒˆ (Churn), 0: ë¹„ì´íƒˆ (Not Churn)

df_all['churn'] = np.select(churn_conditions, churn_choices, default=np.nan)
```

<br>

#### * í•„í„°ë§
```python
df_model_base = df_all[df_all['churn'].notna()].copy() # 'churn'ê°’ì´ NaNì´ ì•„ë‹Œ ê²½ìš° í•„í„°ë§
```

<br>
  
#### * 2ê°œë…„ ê¸°ì´ˆ ë°ì´í„° 
<img width="500" height="198" alt="image" src="https://github.com/user-attachments/assets/d8c182a7-6868-40a7-adc0-f6da4f0a2ce4" />

<br>
<br>

#### * 24ë…„ë„ ë³€ìˆ˜ ë³€ê²½ ë‚´ìš© ì»¬ëŸ¼ ì¶”ê°€
<img width="1540" height="198" alt="image" src="https://github.com/user-attachments/assets/5b23701e-db7c-4bb6-a163-677e97b8e6be" />

â†’ ì´ 31ê°œ í”¼ì²˜, 1712ê°œ ë¡œìš° ìˆ˜ ìƒì„±

<br>
<br>

### ğŸ”¹3. EDA

#### * íŒŒìƒ ë³€ìˆ˜ ì¶”ê°€
```python
# 2. ë³€í™”ëŸ‰(ì°¨ì´) íŒŒìƒë³€ìˆ˜ ìƒì„±
df_final['d01_change'] = df_final['d01_y'] - df_final['d01_x']
df_final['d02_change'] = df_final['d02_y'] - df_final['d02_x']
df_final['d03_change'] = df_final['d03_y'] - df_final['d03_x']
df_final['d04_change'] = df_final['d04_y'] - df_final['d04_x']
df_final['income_change'] = df_final['income_y'] - df_final['income_x']
df_final['job_change'] = (df_final['job_y'] != df_final['job_x']).astype(int)  # ì§ì—… ë³€ë™ ì—¬ë¶€
```
<br>

#### * ë³€ìˆ˜ë³„ ìƒê´€ê³„ìˆ˜ 
<img width="600" height="550" alt="image" src="https://github.com/user-attachments/assets/723d36c7-57d0-4725-97d8-5fb8a5d00063" />

<br>

### â†’ ëª¨ë¸ ì„±ëŠ¥ ì¶”ì¶œ ê°„ ë³€í™” ë‚´ìš© ì—†ìŒ. íŒŒìƒë³€ìˆ˜ ë¯¸ì‚¬ìš©.

<br>
<br>

#### * ì¤‘ìš”ë„ ì¶”ì¶œ
<img width="500" height="600" alt="image" src="https://github.com/SKNETWORKS-FAMILY-AICAMP/SKN17-2nd-4Team/blob/main/image/%EC%A4%91%EC%9A%94%EB%8F%84.png" />

 
<br>
<br>

-----

# 6. ì¸ê³µì§€ëŠ¥ í•™ìŠµ ê²°ê³¼ì„œ 
### ğŸ”¹1. ìµœì´ˆ í•™ìŠµ - XGBclassifier
```python
# X, y ì¤€ë¹„
df = df_final.copy()
df.drop(columns=["pid", "label_x", "label_y", "year_x", "year_y", "gender_y"], inplace=True)

X = df.drop(columns=["churn"])
y = df["churn"]

# ë²”ì£¼í˜• ë¼ë²¨ ì¸ì½”ë”©
X_encoded = X.copy()
for col in X_encoded.select_dtypes(include="object").columns:
    le = LabelEncoder()
    X_encoded[col] = le.fit_transform(X_encoded[col].astype(str))

X_train, X_test, y_train, y_test = train_test_split(
    X_encoded, y, test_size=0.2, random_state=42, stratify=y
)

model = XGBClassifier(
    n_estimators=50,
    max_depth=2,
    learning_rate=0.1,
    random_state=42,
    eval_metric='logloss'
)
# ëª¨ë¸ í•™ìŠµ
model.fit(X_train, y_train)

# ì˜ˆì¸¡ ë° í‰ê°€
y_train_pred = model.predict(X_train)
y_train_prob = model.predict_proba(X_train)[:, 1]
y_test_pred = model.predict(X_test)
y_test_prob = model.predict_proba(X_test)[:, 1]
```
<img width="320" height="320" alt="image" src="https://github.com/user-attachments/assets/ca5404b3-9353-4c15-9c61-c39e694fa421" />

<br>
<br>

### ğŸ”¹2. RandomForest
```python
# íŒŒë¼ë¯¸í„° í›„ë³´
param_grid = {
    'n_estimators': [100, 200, 300],
    'max_depth': [4, 6, 8, None],
    'min_samples_split': [2, 5, 8, 10],
    'min_samples_leaf': [1, 2, 3, 4],
    'max_features': ['sqrt', 0.5, None],
    'class_weight': [None, 'balanced']
}

# ëª¨ë¸ ìƒì„±
rf = RandomForestClassifier(random_state=42)

# GridSearchCV ì„¤ì •
grid_search = GridSearchCV(
    estimator=rf,
    param_grid=param_grid,
    scoring='f1',
    cv=5,
    n_jobs=-1,
    verbose=2
)

# í•™ìŠµ
grid_search.fit(X_train, y_train)

# ìµœì  íŒŒë¼ë¯¸í„° & êµì°¨ê²€ì¦ ì„±ëŠ¥
print("Best Parameters:", grid_search.best_params_)
print("Best CV F1 Score:", grid_search.best_score_)

# ìµœì  ëª¨ë¸
best_rf = grid_search.best_estimator_

# ê³¼ì í•© í™•ì¸
train_acc = best_rf.score(X_train, y_train)
test_acc = best_rf.score(X_test, y_test)
print(f"Train Accuracy: {train_acc:.4f}")
print(f"Test Accuracy : {test_acc:.4f}")
print(f"Overfitting Gap: {train_acc - test_acc:.4f}")

# ë¶„ë¥˜ ë¦¬í¬íŠ¸
y_pred = best_rf.predict(X_test)
print(classification_report(y_test, y_pred))
```
<img width="1423" height="339" alt="image" src="https://github.com/user-attachments/assets/d13bbada-8a07-4335-9207-22402418dc9e" />

<br>
<br>

### ğŸ”¹3. HistGradientBoost
```python
smote = SMOTE(random_state=42)
X_resample, y_resample = smote.fit_resample(X, y)

X_encoded = X_resample.copy()
for col in X_encoded.select_dtypes(include='object').columns:
    le = LabelEncoder()
    X_encoded[col] = le.fit_transform(X_encoded[col].astype(str))

X_train, X_test, y_train, y_test = train_test_split(X_encoded, y_resample, random_state=42)

param_grid = {
    'max_iter': [100],
    'max_depth': [5],
    'learning_rate': [0.3],
    'l2_regularization': [10],
    'max_bins': [225]
}

model = HistGradientBoostingClassifier(random_state=42)

grid_search = GridSearchCV(model, param_grid, cv=5, scoring='roc_auc')

grid_search.fit(X_train, y_train)
grid_search.best_params_

best_hist_gb_clf = grid_search.best_estimator_

y_pred_train = best_hist_gb_clf.predict(X_train)
y_prob_train = best_hist_gb_clf.predict_proba(X_train)[:, 1]

y_pred_test = best_hist_gb_clf.predict(X_test)
y_prob_test = best_hist_gb_clf.predict_proba(X_test)[:, 1]
```
<img width="320" height="320" alt="image" src="https://github.com/user-attachments/assets/cbfee80e-f39a-4e1e-aa23-6da47be5010c" />

<br>
<br>

### ğŸ”¹4. GradientBoost
```python
# íŒŒë¼ë¯¸í„° ìµœì í™”
param_grid = {
    'n_estimators': [100, 300, 500],      # íŠ¸ë¦¬ ê°œìˆ˜
    'learning_rate': [0.1, 0.05, 0.01],   # ì‘ì„ìˆ˜ë¡ ì„±ëŠ¥ â†‘, ëŒ€ì‹  íŠ¸ë¦¬ ìˆ˜ í•„ìš”
    'max_depth': [3, 5, 7],               # ê°œë³„ íŠ¸ë¦¬ ìµœëŒ€ ê¹Šì´
    'min_samples_split': [2, 5, 10],      # ë…¸ë“œ ë¶„í•  ìµœì†Œ ìƒ˜í”Œ ìˆ˜
    'min_samples_leaf': [1, 3, 5],        # ë¦¬í”„ ë…¸ë“œ ìµœì†Œ ìƒ˜í”Œ ìˆ˜
    'subsample': [0.8, 1.0],              # ìƒ˜í”Œë§ ë¹„ìœ¨
    'max_features': ['sqrt', 'log2', None]# íŠ¹ì„± ìƒ˜í”Œë§
}

model = GradientBoostingClassifier(random_state=42)

grid_search = GridSearchCV(model, param_grid, cv=5, scoring='roc_auc')

grid_search.fit(X_train, y_train)
grid_search.best_params_

best_hist_gb_clf = grid_search.best_estimator_

y_pred_train = best_hist_gb_clf.predict(X_train)
y_prob_train = best_hist_gb_clf.predict_proba(X_train)[:, 1]

y_pred_test = best_hist_gb_clf.predict(X_test)
y_prob_test = best_hist_gb_clf.predict_proba(X_test)[:, 1]

print("\n===== XGBoost - Train Set Evaluation =====")
print(classification_report(y_train, y_pred_train))
print(f'{roc_auc_score(y_train, y_prob_train):.4f}')

print("\n===== XGBoost - Test Set Evaluation =====")
print(classification_report(y_test, y_pred_test))
print(f'{roc_auc_score(y_test, y_prob_test):.4f}')
```
<img width="320" height="320" alt="image" src="https://github.com/user-attachments/assets/fe912a84-7533-4966-b2b0-4d163918bfb8" />


<br>
<br>

### ğŸ”¹5. ìµœì¢… : XGBooat - ê·œì œ 
```python
X = df_final.drop(['churn'], axis=1)
y = df_final['churn']

smote = SMOTE(random_state=42)
X_resample, y_resample = smote.fit_resample(X, y)

X_encoded = X_resample.copy()
for col in X_encoded.select_dtypes(include='object').columns:
    le = LabelEncoder()
    X_encoded[col] = le.fit_transform(X_encoded[col].astype(str))

X_train, X_test, y_train, y_test = train_test_split(X_encoded, y_resample, random_state=42)

param_grid = {
    'n_estimators': [100, 200, 300],
    'learning_rate': [0.01, 0.07, 0.1],
    'max_depth': [3, 5, 10],
    'min_child_weight': [0.01, 0.05, 0.1],
    'subsample': [0.1, 0.5, 0.8],
    'colsample_bytree': [1.0],
    'reg_lambda': [10],
    'reg_alpha': [0],
    'gamma': [0, 1]
}

model = XGBClassifier(random_state=42)

grid_search = GridSearchCV(model, param_grid, cv=5, scoring='roc_auc')

grid_search.fit(X_train, y_train)
grid_search.best_params_
```
<img width="300" height="200" alt="image" src="https://github.com/user-attachments/assets/d9b46fda-b1ba-4d91-aa1d-66ac98c79f3f" />

<br>

```python
best_xgb_clf = grid_search.best_estimator_

y_pred_train = best_xgb_clf.predict(X_train)
y_prob_train = best_xgb_clf.predict_proba(X_train)[:, 1]

y_pred_test = best_xgb_clf.predict(X_test)
y_prob_test = best_xgb_clf.predict_proba(X_test)[:, 1]
```
<img width="320" height="320" alt="image" src="https://github.com/user-attachments/assets/dd6c2090-319f-4c99-a61d-3b7e04d63950" />


<br>
<br>

-----

# 7.Â ìˆ˜í–‰ê²°ê³¼


<br>
<br>

-----

# 8.Â í•œÂ ì¤„Â íšŒê³ 
|ì´ë¦„|ë‚´ìš©|
|:---:|:---|
|ê¹€ì£¼ì˜| |
|ì „ìƒì•„| |
|ì¡°í•´ë¦¬|ì„¤ë¬¸ì¡°ì‚¬ ë°ì´í„°ì—¬ì„œ ë°ì´í„°ë¥¼ íŒŒì•…í•˜ëŠ” ê²ƒë¶€í„°ê°€ ì •ë§ í˜ë“¤ì—ˆê³ , ì „ì²˜ë¦¬ ê³¼ì •ì—ì„œë„ ì‹œí–‰ì°©ì˜¤ê°€ ë§ì•˜ë‹¤. íŠ¹íˆ ëª¨ë¸ ì„±ëŠ¥ì´ ì–´ë–»ê²Œ ëŒë ¤ë„ 63%ì—ì„œ ì˜¤ë¥´ì§€ ì•Šì•„ ì–´ë ¤ì›€ì„ ê²ªì—ˆì§€ë§Œ, ì „ì²˜ë¦¬ ê³¼ì •ì—ì„œì˜ ì‹¤ìˆ˜ë¥¼ ë°œê²¬í•˜ê³  ìˆ˜ì •í–ˆì„ ë•Œ ì„±ëŠ¥ì´ í™•ì‹¤íˆ ê°œì„ ë˜ëŠ” ê²½í—˜ì„ í–ˆë‹¤. ì´ë¥¼ í†µí•´ ë°ì´í„° ë¶„ì„ì—ì„œ ì „ì²˜ë¦¬ì˜ ì¤‘ìš”ì„±ì„ í¬ê²Œ ëŠë‚„ ìˆ˜ ìˆì—ˆë‹¤.|
|ìµœìš°ì§„| |
